<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agente de Inventario IA</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        
        <!-- SIDEBAR -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-icon">ü§ñ</span>
                    <span class="logo-text">Agente IA</span>
                </div>
            </div>
            
            <div class="sidebar-content">
                <button class="new-session-btn" id="newSessionBtn" type="button">
                    <span>‚ûï</span>
                    Nueva Sesi√≥n
                </button>
                
                <div class="session-stats">
                    <div class="stat-item">
                        <span class="stat-label">Fotos capturadas</span>
                        <span class="stat-value" id="photoCount">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Estado</span>
                        <span class="stat-value stat-status" id="sessionStatus">Listo</span>
                    </div>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <div class="footer-info">
                    <small>Agente de Gesti√≥n de Inventario</small>
                    <small class="footer-version">v1.0</small>
                </div>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            
            <!-- CHAT INTERFACE -->
            <div id="chatInterface" class="chat-interface active">
                <div class="chat-header">
                    <h1>üì¶ Registro de Productos</h1>
                    <p class="chat-subtitle">Asistente inteligente con OCR y an√°lisis autom√°tico</p>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <!-- Mensaje de bienvenida -->
                    <div class="message agent-message">
                        <div class="message-avatar">ü§ñ</div>
                        <div class="message-content">
                            <div class="message-text">
                                <p>¬°Hola! Soy tu asistente de inventario.</p>
                                <p>Puedo ayudarte a registrar productos usando la c√°mara. Extraer√© informaci√≥n como nombre, marca, tama√±o, c√≥digo de barras y m√°s.</p>
                                <p><strong>¬øComenzamos?</strong> Toma 3 fotos del producto:</p>
                                <ul>
                                    <li>üì∏ <strong>Frontal</strong> - Nombre y marca</li>
                                    <li>üì∏ <strong>Lateral izquierdo</strong> - Ingredientes</li>
                                    <li>üì∏ <strong>Lateral derecho</strong> - Informaci√≥n nutricional</li>
                                </ul>
                            </div>
                            <div class="message-actions">
                                <button class="action-btn primary" id="startCameraBtn" type="button">
                                    <span>üì∑</span>
                                    Iniciar C√°mara
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chat-input-container">
                    <div class="photos-preview" id="photosPreview"></div>
                    
                    <div class="chat-input-wrapper">
                        <button class="camera-toggle-btn" id="cameraToggleBtn" type="button">
                            <span>üì∑</span>
                        </button>
                        <div class="input-status" id="inputStatus">
                            Listo para capturar fotos
                        </div>
                    </div>
                </div>
            </div>

            <!-- C√ÅMARA MODAL -->
            <div id="cameraModal" class="camera-modal">
                <div class="camera-modal-content">
                    <div class="camera-modal-header">
                        <div class="camera-step-info">
                            <h3 id="cameraStepTitle">üì∏ Vista Frontal</h3>
                            <p id="cameraStepDesc">Coloque el producto de frente</p>
                        </div>
                        <button class="close-camera-btn" id="closeCameraBtn" type="button">‚úï</button>
                    </div>
                    
                    <div class="camera-viewport">
                        <video id="videoElement" autoplay playsinline></video>
                        <canvas id="canvas" style="display: none;"></canvas>
                        
                        <div class="camera-overlay">
                            <div class="frame-guide"></div>
                        </div>
                    </div>
                    
                    <div class="camera-controls">
                        <button class="capture-btn" id="captureBtn" type="button">
                            <span class="camera-icon">üì∑</span>
                            <span class="capture-text">Capturar</span>
                        </button>
                    </div>
                    
                    <div class="camera-progress">
                        <div class="progress-dots">
                            <span class="dot" data-step="0"></span>
                            <span class="dot" data-step="1"></span>
                            <span class="dot" data-step="2"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PREVIEW MODAL -->
            <div id="previewModal" class="preview-modal">
                <div class="preview-modal-content">
                    <div class="preview-header">
                        <h3>Vista Previa</h3>
                        <button class="close-preview-btn" id="closePreviewBtn" type="button">‚úï</button>
                    </div>
                    
                    <div class="preview-image-container">
                        <img id="previewImage" src="" alt="Preview">
                    </div>
                    
                    <div class="preview-actions">
                        <button class="btn btn-secondary" id="retakeBtn" type="button">
                            üîÑ Reintentar
                        </button>
                        <button class="btn btn-primary" id="confirmPhotoBtn" type="button">
                            ‚úì Confirmar
                        </button>
                    </div>
                </div>
            </div>

            <!-- PROCESSING OVERLAY -->
            <div id="processingOverlay" class="processing-overlay">
                <div class="processing-card">
                    <div class="processing-spinner"></div>
                    <h3>Procesando con IA...</h3>
                    <p id="processingStatus">Analizando im√°genes...</p>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    
                    <small class="processing-note">Este proceso puede tardar 30-60 segundos</small>
                </div>
            </div>

            <!-- FORM MODAL -->
            <div id="formModal" class="form-modal">
                <div class="form-modal-content">
                    <div class="form-header">
                        <h2>üìù Verificar Informaci√≥n</h2>
                        <button class="close-form-btn" id="closeFormBtn" type="button">‚úï</button>
                    </div>
                    
                    <div class="form-body">
                        <div class="product-preview-card">
                            <div class="product-image-mini" id="productImageMini"></div>
                            <div class="confidence-badge" id="confidenceBadge"></div>
                        </div>

                        <form id="productForm" class="product-form">
                            <div class="form-section">
                                <h4>Informaci√≥n B√°sica</h4>
                                
                                <div class="form-field">
                                    <label>Nombre del Producto *</label>
                                    <input type="text" id="name" placeholder="Ej: Leche Entera" required>
                                </div>

                                <div class="form-row">
                                    <div class="form-field">
                                        <label>Marca *</label>
                                        <input type="text" id="brand" placeholder="Ej: Gloria" required>
                                    </div>
                                    <div class="form-field">
                                        <label>Tama√±o *</label>
                                        <input type="text" id="size" placeholder="1000 ml" required>
                                    </div>
                                </div>

                                <div class="form-field">
                                    <label>Presentaci√≥n</label>
                                    <input type="text" id="presentation" placeholder="Ej: Caja Tetra Pak">
                                </div>
                            </div>

                            <div class="form-section">
                                <h4>Identificaci√≥n</h4>
                                
                                <div class="form-row">
                                    <div class="form-field">
                                        <label>C√≥digo de Barras</label>
                                        <input type="text" id="barcode" placeholder="7501234567890">
                                    </div>
                                    <div class="form-field">
                                        <label>Lote</label>
                                        <input type="text" id="batch" placeholder="L12345">
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h4>Informaci√≥n Adicional</h4>
                                
                                <div class="form-row">
                                    <div class="form-field">
                                        <label>Fecha de Vencimiento</label>
                                        <input type="date" id="expiry">
                                    </div>
                                    <div class="form-field">
                                        <label>Precio (S/)</label>
                                        <input type="number" id="price" step="0.01" placeholder="0.00">
                                    </div>
                                </div>
                            </div>

                            <div class="warning-box" id="warningBox" style="display: none;"></div>

                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" id="cancelFormBtn">
                                    Cancelar
                                </button>
                                <button type="submit" class="btn btn-success">
                                    <span>üíæ</span>
                                    Guardar Producto
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>